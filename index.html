<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Catálogo Biblioteca Euneiz</title>

  <link rel="icon" href="logo.png" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="logo.png" alt="Logo Universidad Euneiz" class="logo" />
      <div>
        <h1>Biblioteca Universitaria — Euneiz</h1>
        <p class="subtitle">Catálogo — Búsqueda por título (Ciencias de la Salud / Nuevas Tecnologías Interactivas)</p>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="controls card">
      <div class="row">
        <label for="facultySelect">Facultad</label>
        <select id="facultySelect">
          <option value="all">Todas las facultades</option>
          <option value="salud">Ciencias de la Salud</option>
          <option value="tecnologias">Nuevas Tecnologías Interactivas</option>
        </select>
      </div>

      <div class="row">
        <label for="searchInput">Buscar por título</label>
        <input id="searchInput" type="search" placeholder="Introduce título (o parte)..." />
        <button id="searchBtn" class="btn">Buscar</button>
        <button id="showAllBtn" class="btn ghost">Mostrar todos</button>
      </div>

      <div class="row small">
        <label>Formato detectado</label>
        <div id="formatsInfo">Cargando archivos...</div>
      </div>
    </section>

    <section class="results card">
      <h2>Resultados</h2>
      <div id="resultsList" class="list"></div>
      <div id="noResults" class="noresults" hidden>No se han encontrado libros.</div>
    </section>

    <aside class="sidebar card">
      <h3>Instrucciones de préstamo</h3>
      <p>Para solicitar préstamo, podéis acudir al mostrador de Secretaría en horario de <strong>lunes a viernes de 10:00 a 18:00</strong>.</p>
      <p>Recordad que la devolución fuera de plazo, el mal estado o la pérdida del material puede implicar sanciones según la normativa.</p>
    </aside>
  </main>

  <footer class="footer">
    <p>&copy; Universidad Euneiz — Biblioteca Universitaria</p>
  </footer>

  <!-- ========================================== -->
  <!--  ✅ CARGA SEGURA DE LIBRERÍAS Y APP.JS     -->
  <!-- ========================================== -->
  <script>
    // Cargar la librería XLSX y luego app.js de forma secuencial
    (async () => {
      try {
        console.log("⏳ Cargando librería XLSX...");
        await new Promise((resolve, reject) => {
          const s = document.createElement("script");
          s.src = "https://cdn.jsdelivr.net/npm/xlsx@0.19.2/dist/xlsx.full.min.js";
          s.onload = resolve;
          s.onerror = reject;
          document.head.appendChild(s);
        });
        console.log("✅ Librería XLSX cargada correctamente");

        console.log("⏳ Cargando app.js...");
        await new Promise((resolve, reject) => {
          const s = document.createElement("script");
          s.src = "app.js?v=" + Date.now(); // fuerza recarga sin caché
          s.onload = resolve;
          s.onerror = reject;
          document.body.appendChild(s);
        });
        console.log("✅ app.js cargado correctamente");
      } catch (err) {
        console.error("❌ Error cargando scripts:", err);
        alert("Error al cargar dependencias. Revisa la conexión o la ruta de los archivos.");
      }
    })();
  </script>
</body>
</html>
